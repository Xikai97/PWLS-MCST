## PWLS-MCST

This is testing and training code for PWLS-MCST in "Multi-layer Clustering-based Residual Sparsifying Transform for Low-dose CT Image Reconstruction". We train the proposed MCST model with different depths based on XCAT phantom data and Mayo Clinic data. The learned transforms can be incorporated into regularizer to improve image quality for low-dose CT reconstruction. 

If you use our code, please cite our paper:

[1] X. Yang, Z. Huang, Y. Long, and S. Ravishankar, “Multi-layer Clustering-based Residual Sparsifying Transform for Low-dose CT Image Reconstruction,” 2022, arXiv:2203.11565. Available: [https://arxiv.org/abs/2203.11565](https://arxiv.org/abs/2203.11565)

All rights are reserved by the authors.

Xikai Yang -2022/08/03. For more detail, feel free to contact: yangxk@sjtu.edu.cn

### Model Training

Run Learn_Transfrom_MCST_xxx.m, the learned transforms will be saved in the learned_trans_mcst_xxx folder.

### CT Image Reconstruction

* To reconstruct CT image from sinogram data, Michigan Image Reconstruction Toolbox (MIRT) is required. One can install it follow [MIRT](https://web.eecs.umich.edu/~fessler/code/index.html).

* Before running main_fan_pwls_MCST_xxx.m, Sinogram data with a specific X-ray dose can be generated by running data_maker_HU_xxx.m. 

* Run main_fan_pwls_MCST_xxx.m, the reconstructed results will be saved in the recon_mcst_xxx folder.
